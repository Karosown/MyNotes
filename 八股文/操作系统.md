# 概述

## **什么是操作系统**

*管理计算机硬件和软件资源的系统软件*

- 管理计算机系统的硬软件
- 分配调度资源的系统软件

## 操作系统的目标

方便性、**有效性**、可扩充性、开放性

> 提高系统资源的利用率，提高系统的吞吐量

## 基本功能

- 统一管理计算机资源
  - 处理器资源
  - IO设备资源
  - 存储器资源
  - 文件资源
- 实现计算机资源的抽象
  - IO设备管理软件提供读写接口、文件管理软件提供操作文件接口
- 提供用户与计算机之间的接口
  - GUI
  - 命令行事
  - 系统调用形式

## 特征

最基本的特征，互为存在的条件：并发、共享

- 并发：

  - 指两个和多个事件可以在同一时间间隔发生（同一时间段，但这个事件段很短），宏观的同时，实际交替执行

- 并行：

  - 指两个或多个事件可以在同一时刻（同一个时间点）发生，多个CPU可以实现并行，一个CPU同一时刻只有一个程序在运行，同理可以在单个CPU上实现并发

- 共享：

  OS中的资源可以共多个并发的程序共同使用

  - 互斥共享：当资源被占用时，其他想使用的程序智能等待
  - 同时访问：某种资源并发的被多个程序访问

- 虚拟

  把一个物理实体转变为若干个逻辑实体

  - **时分复用技术**：资源在时间上进行复用，不同程序并发使用，多道程序分时使用计算机的硬件资源，提高资源的利用率。
  - **空分复用技术**：用来实现虚拟磁盘（物理磁盘虚拟为逻辑磁盘，电脑上的C盘、D盘等）、虚拟内存（在逻辑上扩大程序的存储容量）等，提高资源的利用率，提高编程效率。

- 异步

  在多道程序环境下，允许多个进程并发执行，但由于资源等因素的限制，使进程的执行以“停停走走”的方式运行，而且每个进程**执行的情况**（运行、暂停、速度、完成）也是**未知的**。

## 中断处理

中断机制的作用：为了在多道批处理系统中让用户进行交互；

### 一.单道批处理系统

#### 1.概念

![在这里插入图片描述](https://img-blog.csdnimg.cn/2020042915030730.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjA2OTE0,size_16,color_FFFFFF,t_70)

#### 2.特点

- 自动：作业自动运行，无需干预
- 批量：磁带上的各个作业按顺序地进入内存，先调入先完成
- 单道：内存中仅有一道程序运行，可以看成是串行的

#### 3.CPU的利用情况

![在这里插入图片描述](https://img-blog.csdnimg.cn/20200429152109103.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjA2OTE0,size_16,color_FFFFFF,t_70)

分析：外设和CPU交替空闲和忙碌，CPU和外设利用效率低

#### 4.缺点

从单道批处理系统对CPU的利用情况可看出，作业运行过程中若发生IO请求，高速的CPU要等待低速的I/O操作完成，导致CPU资源利用率和系统[吞吐量](https://so.csdn.net/so/search?q=吞吐量&spm=1001.2101.3001.7020)降低。

### 二. 多道批处理系统

#### 1.概念

内存中存放多道程序，当某道程序因某种原因如执行I/O操作时而不能继续运行放弃CPU时，操作系统便调度另一程序运行，这样CPU就尽量忙碌，达到提高系统效率的目的。

#### 2.特点

多道：内存同时存放多道程序
宏观上并行：进入系统的多道程序先后开始了自己的运行，但都未运行完毕
微观上串行：内存中多道程序轮流占有CPU，交替执行

#### 3.CPU的利用情况

![在这里插入图片描述](https://img-blog.csdnimg.cn/20200429152159264.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQzNjA2OTE0,size_16,color_FFFFFF,t_70)


分析：程序A要通过操作系统的调度进行磁盘操作，B则进行磁带操作。当程序A执行I/O请求时，A放弃了CPU，操作系统接着调度B，B开始占用CPU（红宽线）,此时程序A的磁盘操作也在同时进行。

结论：A,B两道程序相互穿插运行，使CPU和外设都尽量忙碌。

#### 4.缺点

- 作业处理时间长
- 交互能力差
- 运行过程不确定

### 中断产生：

- 发生中断时，CPU立马切换到管态，开展管理工作；（管态又叫特权态，系统态或核心态，是操作系统管理的程序执行时，机器所处的状态。）

- 发生中断后，当前运行的进程回暂停运行，由操作系统内核对中断进行处理；
- 对于不同的中断信号，会进行不同的处理。

### 中断的分类：

- 内中断（也叫“异常”、“例外”、“陷入”）------- 信号来源：CPU内部，与当前执行指令有关；

- 外中断（中断）----------信号来源：CPU外部，与当前执行指令无关。

### 外中断的处理过程：

- 每执行完一个指令后，CPU都需要检查当前是否有外部中断信号；
- 如果检查到外部中断信号，则需要保护被中断进程的CPU环境（如程序状态字PSW，程序计数器PC、各种通用寄存器）把他们存储在PCB（进程控制块中）；
- 根据中断信号类型转入相应的中断处理程序；
- 恢复原进程的CPU环境并退出中断，返回原进程继续执行。

# 进程管理

## 进程实体

### 为什么需要进程：

1. 进程是系统进行**资源分配和调度的基本单位**；
2. 进程作为程序独立运行的载体保障程序正常执行；
3. 进程的存在使得操作系统资源的利用率大幅提升。+

### 进程控制块（PCB）

用于描述和控制进程运行的通用数据结构,记录进程当前状态和控制进程运行的全部信息，**是进程存在的唯一标识**。

### **进程（Process）与线程（Thread）**：

- **线程**：操作系统进行**运行调度的最小单位**。
- **进程**：系统进行**资源分配和调度的基本单位**。

**区别与联系**：

- **一个进程可以有一个或多个线程**；
- **线程包含在进程之中，是进程中实际运行工作的单位**；
- **进程的线程共享进程资源**；
- **一个进程可以并发多个线程，每个线程执行不同的任务**。

![image-20210826153718544](https://img-blog.csdnimg.cn/img_convert/57105faf208a76086d4ae131c69d5cc0.png)

##  进程管理五状态模型

- 就绪状态：其它资源（进程控制块、内存、栈空间、堆空间等）都准备好、只差CPU的状态。
- 执行状态：进程获得CPU，其程序正在执行。
- 阻塞状态：进程因某种原因放弃CPU的状态，阻塞进程以队列的形式放置。
- 创建状态：创建进程时拥有PCB但其它资源尚未就绪。
- 终止状态：进程结束由系统清理或者归还PCB的状态。

